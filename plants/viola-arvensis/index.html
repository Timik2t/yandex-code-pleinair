<!DOCTYPE html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
<script>
  function setup(){ 
  createCanvas(450, 800);
  noLoop(); 
}

function draw(){ 
  background("white");    
  strokeWeight(30); 
  translate(width/2,height-20); 
  fill("brown");
  branch(0); 
} 

function branch(depth){ 
  if (depth < 11) { 
    const branchLength = height/80+
          depth*10+random(height/20)
    line(0,0,0,-branchLength); // draw a line going up
    { 
      translate(0,-branchLength); // move the space upwards
      rotate(random(-0.09,0.09));  // random wiggle
      const angle = 0.2+random(0.2);
      if (random(1.0) < 1 - depth/14){ // branching   
        rotate(angle); // rotate to the right
        scale(0.65,0.8); // scale down
        
        push(); // now save the transform state
        branch(depth + 1); // start a new branch!
        pop(); // go back to saved state
        
        rotate(-angle*2); // rotate back to the left 
        
        push(); // save state
        branch(depth + 1);   // start a second new branch 
        pop(); // back to saved state        
     } 
      else { // no branch - continue at the same depth  
        branch(depth);
      } 
    } 
  } if (depth >8) {
    fill(random(200), 150+random(100), random(100));
   noStroke();
    for (let i=0;i<20;i++){
        ellipse(
          random()*200,
          random()*200,
          random()*200,
         random()*200          );
      }
  }
} 
</script>
